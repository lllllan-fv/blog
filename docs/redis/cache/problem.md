---
# 这是页面的图标
icon: cache

# 这是文章的标题
title: 缓存击穿、穿透和雪崩

# number | boolean	
# 侧边栏按 indx 从小到大排序，false 则不出现在侧边栏
index: 1

# 写作日期
# date: 2022-01-01

# 一个页面可以有多个分类
category: 

# 一个页面可以有多个标签
tag: 

# 你可以自定义页脚
# footer: 这是测试显示的页脚
---



## 缓存击穿



> **缓存中没有但数据库中有的数据**，当并发请求较多时，同时读缓存没有读到数据、又同时去数据库读取数据，引起数据库压力瞬间增大、造成过大压力。



解决方案：

1. 设置热点数据永不过期
2. 接口限流、熔断、降级。
   - 重要的接口一定要做好限流策略，防止用户恶意刷接口
   - 同时要做好降级准备，当接口中某些服务不可用时，进行熔断
3. 加互斥锁



## 缓存穿透



> **缓存和数据库中都没有的数据**，如果数据库查不到数据不写入缓存，将导致不存在的数据每次请求倒要到数据库中查询；当流量较大时，数据库可能会崩溃。



解决方案：

1. 接口层增加校验，对于无效、恶意的请求直接拦截
2. 对于数据库中不存在的数据，可以在缓存中写为 `key-null`，出于容错考虑可以将过期时间设置短一些
3. 布隆过滤器，用于快速判某个元素是否存在于集合中



## 缓存雪崩



> **缓存中大批量数据同时过期**，而请求量巨大，引起数据库压力国安的甚至宕机。==缓存击穿指并发请求同一数据，缓存雪崩指大批量数据过期。==



解决方案：

1. 过期时间设置为随机值，防止大量数据同时过期
2. 将热点数据均匀分布在不同的缓存数据库中
3. 设置热点数据永不过期



## 参考

- [Redis进阶 - 缓存问题：一致性, 穿击, 穿透, 雪崩, 污染等 | Java 全栈知识体系 (pdai.tech)](https://pdai.tech/md/db/nosql-redis/db-redis-x-cache.html)
- [什么是缓存雪崩、击穿、穿透？ | 小林coding (xiaolincoding.com)](https://xiaolincoding.com/redis/cluster/cache_problem.html)
